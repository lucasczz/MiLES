\documentclass{standalone}
\usepackage{tikz}
\usepackage{tikz-3dplot}

\begin{document}

\tdplotsetmaincoords{70}{20} % Set viewing angle

\begin{tikzpicture}[tdplot_main_coords]

% Grid and image configuration
\def\hexsize{1} % Radius of a single hexagon
\def\xsteps{6}   % Number of hexagons in the x direction
\def\ysteps{6}   % Number of hexagons in the y direction
\pgfmathsetmacro{\gridwidth}{\xsteps * \hexsize * 1.5 + 2 * \hexsize}
\pgfmathsetmacro{\gridheight}{\ysteps * \hexsize * sqrt(3) + 1.5 * \hexsize * sqrt(3)}

% First node with the map scaled to match the grid dimensions
\node[canvas is xy plane at z=0, draw, fill=white, anchor=south west] at (0, 0) 
{\includegraphics[width=\gridwidth cm, height=\gridheight cm]{map.png}};

% Viridis colormap as RGB triples
\def\viridisColors{{"0.267004 0.004874 0.329415", "0.127568 0.566949 0.550556", 
                    "0.369214 0.788888 0.382914", "0.993248 0.906157 0.143936"}}

% Loop to draw multiple hexagonal grids
\foreach \i/\z [count=\n from 0] in {1/3,2/6,3/9} {
    % Select the color
    \pgfmathparse{\viridisColors[\i]};
    \definecolor{currentColor}{rgb}{\pgfmathresult};
    
    \pgfmathsetmacro{\xsteps}{6 + \z}   % Adjust grid size based on z-coordinate
    \pgfmathsetmacro{\ysteps}{6 + \z}   % Adjust grid size based on z-coordinate
    \pgfmathsetmacro{\hexsize}{\gridwidth / (1.5 * \xsteps + 2)}

    \begin{scope}[canvas is xy plane at z=\z]
        % Draw rectangle (background for the grid)
        \filldraw[draw=black, fill=currentColor, fill opacity=0.8] (0, 0) rectangle ++ (\gridwidth, \gridheight);
        
        % Loop to create hexagonal grid
        \foreach \x in {0,...,\xsteps} {
            \foreach \y in {0,...,\ysteps} {
                % Offset every second row to create a hexagonal grid
                \pgfmathsetmacro{\xoffset}{(\x + 1) * \hexsize * 1.5}
                \pgfmathsetmacro{\yoffset}{\y * \hexsize * sqrt(3) + mod(\x, 2) * \hexsize * sqrt(3) / 2}
                
                % Draw hexagon
                \draw[black] 
                    (\xoffset, \yoffset) -- ++(60:\hexsize) -- ++(120:\hexsize) 
                    -- ++(180:\hexsize) -- ++(240:\hexsize) -- ++(300:\hexsize) -- cycle;
            }
        }
    \end{scope}
}

\end{tikzpicture}

\end{document}
